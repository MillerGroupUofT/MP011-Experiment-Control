
% Build configuration parameters panel for stages
function [] = BuildConfigPanel(hObject, event, funcName)

    % Load handles from base workspace
    handles = evalin('base','handles');
    
    switch(funcName)
        
        case {'stages config 1', 'stages config 2', 'stages config 3', 'stages config 4', 'stages config 5'}

			i = str2double(funcName(end));

			% Table for values
			handles.figGUI_menuStages_menuConfig_fig_table = uitable(...
		        'Parent', hObject, ...
		        'FontName', handles.gui_editFontName, ...
		        'BackgroundColor', handles.gui_tableBackgroundColor, ...
		        'ForegroundColor', handles.gui_editFontColor, ...
		        'RowStriping', 'on', ...
		        'ColumnName', {'Parameters', 'Value', 'Set to...'}, ...
		        'ColumnEditable', [false, false, true], ...
		        'ColumnFormat', {'char', 'char', 'char'}, ...
		        'Units', 'pixels', ...
		        'Position', [10 10 200 200], ...
                'CellEditCallback', {@CallbackFunc_Celledit, sprintf('stages config %d',i)}, ...
                'CellSelectionCallback', {@CallbackFunc_Cellselection, sprintf('stages config %d',i)} ...
		        );


            % Save handles in base workspace
            assignin('base','handles',handles)

            CallbackFunc_Pressbutton(handles.figGUI_menuStages_menuConfig_fig_table, [], {'Stages', sprintf('get config %d', i)}, [])


		case('camera status')

			% Table for values
			handles.figGUI_menuCamera_menuStatus_fig_table = uitable(...
		        'Parent', hObject, ...
		        'FontName', handles.gui_editFontName, ...
		        'BackgroundColor', handles.gui_tableBackgroundColor, ...
		        'ForegroundColor', handles.gui_editFontColor, ...
		        'RowStriping', 'on', ...
		        'ColumnName', {'Parameters', 'Value'}, ...
		        'ColumnEditable', [true, true], ...
		        'ColumnFormat', {'char', 'char'}, ...
		        'Units', 'pixels', ...
                'ColumnWidth', {180, 100}, ...
		        'Position', [10 10 200 140]...
		        );
            
            % Save handles in base workspace
            assignin('base','handles',handles)

			% Get values from controller
			CallbackFunc_Camera(handles.figGUI_menuCamera_menuStatus_fig_table, [], 'get status'); 

		case('camera image settings')

			% Table for values
			handles.figGUI_menuCamera_menuImgSettings_fig_table = uitable(...
		        'Parent', hObject, ...
		        'FontName', handles.gui_editFontName, ...
		        'BackgroundColor', handles.gui_tableBackgroundColor, ...
		        'ForegroundColor', handles.gui_editFontColor, ...
		        'RowStriping', 'on', ...
		        'ColumnName', {'Parameters', 'Value'}, ...
		        'ColumnEditable', [true, true], ...
		        'ColumnFormat', {'char', 'char'}, ...
		        'Units', 'pixels', ...
                'ColumnWidth', {180, 100}, ...
		        'Position', [10 10 200 200]...
		        );
            
            % Save handles in base workspace
            assignin('base','handles',handles)

			% Get values from controller
			CallbackFunc_Camera(handles.figGUI_menuCamera_menuImgSettings_fig_table, [], 'get image settings'); 

		case('camera config')

			% Table for values
			handles.figGUI_menuCamera_menuConfig_fig_table = uitable(...
		        'Parent', hObject, ...
		        'FontName', handles.gui_editFontName, ...
		        'BackgroundColor', handles.gui_tableBackgroundColor, ...
		        'ForegroundColor', handles.gui_editFontColor, ...
		        'RowStriping', 'on', ...
		        'ColumnName', {'Parameters', 'Value'}, ...
		        'ColumnEditable', [true, true], ...
		        'ColumnFormat', {'char', 'char'}, ...
		        'Units', 'pixels', ...
                'ColumnWidth', {180, 100}, ...
		        'Position', [10 10 200 200]...
		        );

            % Save handles in base workspace
            assignin('base','handles',handles)            

			% Get values from controller
			CallbackFunc_Camera(handles.figGUI_menuCamera_menuConfig_fig_table, [], 'get config'); 

		case('camera custom ROI')
            
            handles.figGUI_panCamera_info = hObject;
            
            % CCD format serial origin
            handles.figGUI_panCamera_ROI_fig_customSerialOri = uicontrol(...
                'Parent', hObject, ...
                'Style', 'text', ...
                'String', 'Serial Origin:', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [10 135 100 15], ...
                'HorizontalAlignment', 'left'...
                );

            % CCD format serial length
            handles.figGUI_panCamera_ROI_fig_customSerialLen = uicontrol(...
                'Parent', hObject, ...
                'Style', 'text', ...
                'String', 'Serial Length:', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [10 110 100 15], ...
                'HorizontalAlignment', 'left'...
                );            

            % CCD format serial binning
            handles.figGUI_panCamera_ROI_fig_customSerialBin = uicontrol(...
                'Parent', hObject, ...
                'Style', 'text', ...
                'String', 'Serial Binning:', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [10 85 100 15], ...
                'HorizontalAlignment', 'left'...
                );

            % CCD format parallel origin
            handles.figGUI_panCamera_ROI_fig_customParaOri = uicontrol(...
                'Parent', hObject, ...
                'Style', 'text', ...
                'String', 'Parallel Origin:', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [10 60 100 15], ...
                'HorizontalAlignment', 'left'...
                );

            % CCD format parallel length
            handles.figGUI_panCamera_ROI_fig_customParaLen = uicontrol(...
                'Parent', hObject, ...
                'Style', 'text', ...
                'String', 'Parallel Length:', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [10 35 100 15], ...
                'HorizontalAlignment', 'left'...
                );


            % CCD format parallel binning
            handles.figGUI_panCamera_ROI_fig_customParaBin = uicontrol(...
                'Parent', hObject, ...
                'Style', 'text', ...
                'String', 'Parallel Binning:', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [10 10 100 15], ...
                'HorizontalAlignment', 'left'...
                );

            %%%%%%%%%%%%%%%%%%%%%%%%

            % CCD format serial origin
            handles.figGUI_panCamera_ROI_fig_customSerialOri_Edit = uicontrol(...
                'Parent', hObject, ...
                'Style', 'edit', ...
                'String', handles.cameraROI_customSerialOri, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [115 135 100 15], ...
                'HorizontalAlignment', 'left', ...
                'Callback', {@UpdateEditValue, 'cameraROI_customSerialOri'}...
            );

            % CCD format serial length
            handles.figGUI_panCamera_ROI_fig_customSerialLen_Edit= uicontrol(...
                'Parent', hObject, ...
                'Style', 'edit', ...
                'String', handles.cameraROI_customSerialLen, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [115 110 100 15], ...
                'HorizontalAlignment', 'left', ...
                'Callback', {@UpdateEditValue, 'cameraROI_customSerialLen'}...
                );

            % CCD format serial binning
            handles.figGUI_panCamera_ROI_fig_customSerialBin_Edit = uicontrol(...
                'Parent', hObject, ...
                'Style', 'edit', ...
                'String', handles.cameraROI_customSerialBin, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [115 85 100 15], ...
                'HorizontalAlignment', 'left', ...
                'Callback', {@UpdateEditValue, 'cameraROI_customSerialBin'}...
                );

            % CCD format parallel origin
            handles.figGUI_panCamera_ROI_fig_customParaOri_Edit = uicontrol(...
                'Parent', hObject, ...
                'Style', 'edit', ...
                'String', handles.cameraROI_customParaOri, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [115 60 100 15], ...
                'HorizontalAlignment', 'left', ...
                'Callback', {@UpdateEditValue, 'cameraROI_customParaOri'}...
                );

            % CCD format parallel length
            handles.figGUI_panCamera_ROI_fig_customParaLen_Edit = uicontrol(...
                'Parent', hObject, ...
                'Style', 'edit', ...
                'String', handles.cameraROI_customParaLen, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [115 35 100 15], ...
                'HorizontalAlignment', 'left', ...
                'Callback', {@UpdateEditValue, 'cameraROI_customParaLen'}...
                );

            % CCD format parallel binning
            handles.figGUI_panCamera_ROI_fig_customParaBin_Edit = uicontrol(...
                'Parent', hObject, ...
                'Style', 'edit', ...
                'String', handles.cameraROI_customParaBin, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [115 10 100 15], ...
                'HorizontalAlignment', 'left', ...
                'Callback', {@UpdateEditValue, 'cameraROI_customParaBin'}...
                );
            
            
            % Save handles in base workspace
            assignin('base','handles',handles)
            
		case('Electron integration')
            
%             handles.figGUI_panCamera_info = hObject;

            handles.axes = axes;
            
            % Modify axis limits
            set(handles.axes, ...
                'Units', 'pixels', ...
                'Position', [100,120,750,450], ...
                'Fontsize', 12, ...
                'Parent', hObject, ...
                'XLim', [0 10], ...
                'LineWidth', 2, ...
                'FontSize', 12, ...
                'FontWeight', 'bold' ...
                );
            
            set(get(handles.axes,'XLabel'), ...
                'String', 'Number of Images', ...
                'FontSize', 14, ...
                'FontWeight', 'bold' ...
                );

            set(get(handles.axes,'YLabel'), ...
                'String', 'Number of Electrons (x 1000)', ...
                'FontSize', 14, ...
                'FontWeight', 'bold' ...
                );

            handles.figGUI_std_text = uicontrol(...
                'Parent', hObject, ...
                'Style', 'text', ...
                'String', 'Stability (%)', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [493 615 120 30], ...
                'HorizontalAlignment', 'left' ...
                );
            
            % Electron stability in %
            handles.figGUI_std = uicontrol(...
                'Parent', hObject, ...
                'Style', 'edit', ...
                'HorizontalAlignment', 'right',...
                'FontName', handles.gui_textFontName, ...
                'FontSize', 12, ...
                'FontWeight', 'bold', ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [500 600 50 30], ...
                'HorizontalAlignment', 'left' ...
                );
            
            % Start electron integration
            handles.figGUI_Start = uicontrol(...
                'Parent', hObject, ...
                'Style', 'pushbutton', ...
                'String', 'Start', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [100 10 100 30], ...
                'HorizontalAlignment', 'left', ...
                'Enable', 'off', ...
                'Callback', 'uiresume(gcbf)' ...
                );

            % Stop electron integration
            handles.figGUI_Stop = uicontrol(...
                'Parent', hObject, ...
                'Style', 'togglebutton', ...
                'String', 'Stop', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [300 10 100 30], ...
                'HorizontalAlignment', 'left', ...
                'Enable', 'off' ...
                );

            % Number of samples for std calculations
            handles.figGUI_stdsamples_text = uicontrol(...
                'Parent', hObject, ...
                'Style', 'text', ...
                'String', '# of samples', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [475 27 100 30], ...
                'HorizontalAlignment', 'left' ...
                );

            
            % Number of samples for std calculations
            handles.figGUI_stdsamples = uicontrol(...
                'Parent', hObject, ...
                'Style', 'edit', ...
                'HorizontalAlignment', 'right',...
                'FontName', handles.gui_textFontName, ...
                'FontSize', 12, ...
                'FontWeight', 'bold', ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [500 10 30 30], ...
                'HorizontalAlignment', 'left' ...
                );

            % Select log file
            handles.figGUI_Select = uicontrol(...
                'Parent', hObject, ...
                'Style', 'pushbutton', ...
                'String', 'Select file ...', ...
                'FontName', handles.gui_textFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'Units', 'pixels', ...
                'Position', [700 10 100 30], ...
                'HorizontalAlignment', 'left', ...
                'Callback', {@electronintegration, hObject, handles.axes, handles.figGUI_Start, handles.figGUI_Stop, handles.figGUI_stdsamples, handles.figGUI_std}...
                );

            % Save handles in base workspace
            assignin('base','handles',handles)
            

		case('HV status')

			% Table for values
			handles.figGUI_menuHV_menuConfig_fig_table = uitable(...
		        'Parent', hObject, ...
		        'FontName', handles.gui_editFontName, ...
		        'BackgroundColor', handles.gui_tableBackgroundColor, ...
		        'ForegroundColor', handles.gui_editFontColor, ...
		        'RowStriping', 'on', ...
                'Tag', 'HVparam', ...
		        'ColumnName', {'Parameters', 'Value', 'Units'}, ...
		        'ColumnEditable', [false, true, false], ...
		        'ColumnFormat', {'char', 'char', 'char'}, ...
		        'Units', 'pixels', ...
                'ColumnWidth', {150, 50, 70}, ...
		        'Position', [2 10 302 168], ...
                'CellEditCallback', {@CallbackFunc_Celledit, 'HV config'}, ...
                'CellSelectionCallback', {@CallbackFunc_Cellselection, 'HV config'} ...
		        );
            
            % Save handles in base workspace
            assignin('base','handles',handles)


            numConfigParam = numel(handles.HV.cmdList)/3;

            currVal = {};
            units = {};
            for(j = 1:numConfigParam)
                descrip{j,1} = handles.HV.cmdList{j};
                currVal{j,1} = handles.HV.cmdList{j+numConfigParam};
                units{j,1} = handles.HV.cmdList{j+2*numConfigParam};
            end
            
            % Set data in configuration parameter table
            set(handles.figGUI_menuHV_menuConfig_fig_table, 'Data', [descrip, currVal, units]);

            
		case('micra status')

			% Table for values
			handles.figGUI_menuMicra_menuConfig_fig_table = uitable(...
		        'Parent', hObject, ...
		        'FontName', handles.gui_editFontName, ...
		        'BackgroundColor', handles.gui_tableBackgroundColor, ...
		        'ForegroundColor', handles.gui_editFontColor, ...
		        'RowStriping', 'on', ...
		        'ColumnName', {'Parameters', 'Value'}, ...
		        'ColumnEditable', [false, false false], ...
		        'ColumnFormat', {'char', 'char'}, ...
		        'Units', 'pixels', ...
                'ColumnWidth', {190, 120, 55}, ...
		        'Position', [10 10 290 480], ...
                'CellEditCallback', {@CallbackFunc_Celledit, 'micra config'}, ...
                'CellSelectionCallback', {@CallbackFunc_Cellselection, 'micra config'} ...
		        );

            % Save handles in base workspace
            assignin('base','handles',handles)

            CallbackFunc_Pressbutton(handles.figGUI_menuMicra_menuConfig_fig_table, [], {'Micra', 'get status'}, [])

        case('oscilloscope measurement')
            
            handles.figGUI_menuOscilloscope_menuConfig_fig_title_value = uicontrol(...
                'Parent', hObject, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'ForegroundColor', handles.gui_editFontColor, ...
                'Units','pixel', ...
                'Position', [70 10 100 30], ...
                'Style','text', ...
                'String','Value' ...
                );

            handles.figGUI_menuOscilloscope_menuConfig_fig_value = uicontrol(...
                'Parent', hObject, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'ForegroundColor', handles.gui_editFontColor, ...
                'Units','pixel', ...
                'Position', [70 5 100 20], ...
                'Style','Edit', ...
                'String','' ...
                );

            handles.figGUI_menuOscilloscope_menuConfig_fig_title_measure = uicontrol(...
                'Parent', hObject, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'ForegroundColor', handles.gui_editFontColor, ...
                'Units','pixel', ...
                'Position', [20 70 70 15], ...
                'Style','text', ...
                'String','Measurement' ...
                );

            handles.figGUI_menuOscilloscope_menuConfig_fig_popup_measure = uicontrol(...
                'Parent', hObject, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'ForegroundColor', handles.gui_editFontColor, ...
                'Units','pixel', ...
                'Position', [10 10 100 60], ...
                'Style','popup', ...
                'String',handles.oscilloscope.cmdList, ...
                'Callback', {@CallbackFunc_Pressbutton, {'Oscilloscope', 'set measurement'}, handles.figGUI_menuOscilloscope_menuConfig_fig_value}, ...
                'Value',1 ...
                );
                
            handles.figGUI_menuOscilloscope_menuConfig_fig_title_channel = uicontrol(...
                'Parent', hObject, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'ForegroundColor', handles.gui_editFontColor, ...
                'Units','pixel', ...
                'Position', [140 70 70 15], ...
                'Style','text', ...
                'String','Channel' ...
                );
            
            handles.figGUI_menuOscilloscope_menuConfig_fig_popup_channel = uicontrol(...
                'Parent', hObject, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_panelBackgroundColor, ...
                'ForegroundColor', handles.gui_editFontColor, ...
                'Units','pixel', ...
                'Position', [140 10 100 60], ...
                'Style','popup', ...
                'String',handles.oscilloscope.channelList, ...
                'Callback', {@CallbackFunc_Pressbutton, {'Oscilloscope', 'set channel'}, handles.figGUI_menuOscilloscope_menuConfig_fig_value}, ...
                'Value',1 ...
                );
            
            % Save handles in base workspace
            assignin('base','handles',handles)
            
                
		case('chiller status')

            % Table for values
            handles.figGUI_menuChiller_menuStatus_fig_table = uitable(...
                'Parent', hObject, ...
                'FontName', handles.gui_editFontName, ...
                'BackgroundColor', handles.gui_tableBackgroundColor, ...
                'ForegroundColor', handles.gui_editFontColor, ...
                'RowStriping', 'on', ...
                'ColumnName', {'Parameters', 'Value'}, ...
                'ColumnEditable', [true, true], ...
                'ColumnFormat', {'char', 'logical'}, ...
                'Units', 'pixels', ...
                'ColumnWidth', {180, 55}, ...
                'Position', [10 10 290, 280]...
                );
            
            assignin('base','handles',handles)

			% Get values from controller
            CallbackFunc_Pressbutton(handles.figGUI_menuChiller_menuStatus_fig_table, [], {'Chiller', 'get status'},[])
            
            
        case('chiller control')
            
            handles = BuildChillerPanel(hObject,[],[],handles);
            
            % Save handles in base workspace
            assignin('base','handles',handles)
            
            CallbackFunc_Pressbutton(handles.figGUI_panChiller_tableStatus, [], {'Chiller', 'get status'},[])
            disp(' ')
            CallbackFunc_Pressbutton(handles.figGUI_panChiller_tableConfig, [], {'Chiller', 'get control'},[])

    end
    
end
