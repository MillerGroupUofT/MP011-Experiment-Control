
% Build function for figure windows
function BuildFigureWindows(hObject, event, figName)

    % Load handles from base workspace
    handles = evalin('base','handles');
    
    switch(figName)
		
		% Main GUI
		case('main GUI')
			
		    handles.figGUI = figure(...
		        'Name', 'MP011 Experiment Control GUI', ...
		        'NumberTitle', 'off', ...
		        'Visible', 'on', ...
		        'Position', [100, 100, 1015, 718], ...
		        'Resize', 'off', ...
		        'MenuBar', 'none', ...
		        'CreateFcn', {@CreateFunc_FigWindow, 'main GUI'}, ...
		        'CloseRequestFcn', {@CallbackFunc_Close, 'main GUI'}...
		        );

		% Shutters COM settings
		case('shutters com')

			handles.figGUI_menuShutters_menuCOM_fig = figure(...
	    		'Name', 'Shutters COM Settings', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 460, 175], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'shutters com'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'shutters com'}...
	    		);

		% Camera COM settings
		case('camera com')

			handles.figGUI_menuCamera_menuCOM_fig = figure(...
	    		'Name', 'Camera COM Settings', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 50], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'camera com'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'camera com'}...
	    		);

		% Camera status
		case('camera status')

			handles.figGUI_menuCamera_menuStatus_fig = figure(...
	    		'Name', 'Camera Status', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 300], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...   
	    		'CreateFcn', {@CreateFunc_FigWindow, 'camera status'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'camera status'}...
	    		);		

		% Camera image settings
		case('camera image settings')

			handles.figGUI_menuCamera_menuImgSettings_fig = figure(...
	    		'Name', 'Camera Image Settings', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 300], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...   
	    		'CreateFcn', {@CreateFunc_FigWindow, 'camera image settings'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'camera image settings'}...
	    		);

		% Camera configuration
		case('camera config')

			handles.figGUI_menuCamera_menuConfig_fig = figure(...
	    		'Name', 'Camera Configuration', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 250], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
	    		'Color', handles.gui_panelBackgroundColor, ...   
	    		'CreateFcn', {@CreateFunc_FigWindow, 'camera config'},...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'camera config'}...
	    		);
			
		% Camera Custom ROI settings
		case('camera custom ROI')

			handles.figGUI_panCamera_ROI_fig = figure(...
				'Name', 'Custom ROI Settings', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 150], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
	    		'Color', handles.gui_panelBackgroundColor, ...   
	    		'CreateFcn', {@CreateFunc_FigWindow, 'camera custom ROI'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'camera custom ROI'}...
	    		);

		case('Electron integration')

			handles.figGUI_panCamera_electronint = figure(...
				'Name', 'Electron Integration', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 900, 660], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
	    		'Color', handles.gui_panelBackgroundColor, ...   
	    		'CreateFcn', {@CreateFunc_FigWindow, 'Electron integration'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'Electron integration'}...
	    		);


		% Stages COM settings
		case('stages com')

			handles.figGUI_menuStages_menuCOM_fig = figure(...
				'Name', 'Stage COM Settings', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 700, 175], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
	    		'Color', handles.gui_panelBackgroundColor, ...   
	    		'CreateFcn', {@CreateFunc_FigWindow, 'stages com'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'stages com'}...
	    		);
		
		% Stages configuration parameters
        case {'stages config 1', 'stages config 2', 'stages config 3', 'stages config 4', 'stages config 5'}

			i = str2double(figName(end));

			handles.figGUI_menuStages_menuConfig_fig(i) = figure(...
				'Name', sprintf('%s Stage Configuration Parameters', handles.stages_name{i}), ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 250], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
	    		'Color', handles.gui_panelBackgroundColor, ...   
	    		'CreateFcn', {@CreateFunc_FigWindow, sprintf('stages config %d', i)}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, sprintf('stages config %d', i)}...
				);


		% Command line interface
		case('cli')

			handles.figGUI_menuTools_menuCLI_fig = figure(...
	    		'Name', 'CLI for Server COM', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 180], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...      		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'cli'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'cli'}...
	    		);

		% HV COM settings
		case('hv com')

			handles.figGUI_menuHV_menuCOM_fig = figure(...
	    		'Name', 'High Voltage COM Settings', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 155], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'hv com'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'hv com'}...
	    		);

        % HV status
		case('HV status')

			handles.figGUI_menuHV_menuStatus_fig = figure(...
	    		'Name', 'HV Configuration', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 305, 182], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'HV status'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'HV status'}...
	    		);

            
		% Micra status
		case('micra status')

			handles.figGUI_menuMicra_menuStatus_fig = figure(...
	    		'Name', 'Micra Configuration', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 350, 150], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'micra status'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'micra status'}...
	    		);
            
		% Micra COM settings
		case('micra com')

			handles.figGUI_menuMicra_menuCOM_fig = figure(...
	    		'Name', 'Micra COM Settings', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 155], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'micra com'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'micra com'}...
	    		);

        % Oscilloscope status
		case('oscilloscope measurement')

			handles.figGUI_menuOscilloscope_menuStatus_fig = figure(...
	    		'Name', 'Oscilloscope', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 250, 90], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'oscilloscope measurement'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'oscilloscope'}...
	    		);
            
        % Oscilloscope settings
		case('oscilloscope com')

			handles.figGUI_menuOscilloscope_menuCOM_fig = figure(...
	    		'Name', 'Oscilloscope IP', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 250, 22], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'oscilloscope com'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'oscilloscope com'}...
	    		);

            
		% Chiller COM settings
		case('chiller com')

			handles.figGUI_menuChiller_menuCOM_fig = figure(...
	    		'Name', 'Chiller COM Settings', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 155], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'chiller com'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'chiller com'}...
	    		);

		% Chiller status
		case('chiller status')

			handles.figGUI_menuChiller_menuStatus_fig = figure(...
	    		'Name', 'Chiller Status', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 300, 300], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...       		
	    		'CreateFcn', {@CreateFunc_FigWindow, 'chiller status'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'chiller status'}...
	    		);

		% Chiller control
		case('chiller control')
            
			handles.figGUI_menuChiller_menuControl_fig = figure(...
	    		'Name', 'Chiller Control', ...
	    		'NumberTitle', 'off', ...
	    		'Visible', 'on', ...
	    		'Position', [100, 100, 600, 470], ...
	    		'Resize', 'off', ...
	    		'MenuBar', 'none', ...
        		'Color', handles.gui_panelBackgroundColor, ...
                'CreateFcn', {@CreateFunc_FigWindow, 'chiller control'}, ...
	    		'CloseRequestFcn',{@CallbackFunc_Close, 'chiller ctrl'}...
	    		);

    end

	% Save handles in base workspace
    assignin('base','handles',handles)
     	
end

	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

	% Commands to be executed upon figure creation
	function CreateFunc_FigWindow(hObject, event, figName)
    
        handles = evalin('base','handles');

		% Move GUI window to center of screen
		movegui(hObject, 'center');

		% Build COM settings panel
        if(strcmp(figName((end-2):end), 'com') > 0)

			BuildCOMPanels(hObject, event, figName);

        % Build stages configuration parameters panel
		elseif(strcmp(figName, 'stages config 1') > 0)

			BuildConfigPanel(hObject, event, figName);
            
        elseif(strcmp(figName, 'stages config 2') > 0)

			BuildConfigPanel(hObject, event, figName);

        elseif(strcmp(figName, 'stages config 3') > 0)

			BuildConfigPanel(hObject, event, figName);

		elseif(strcmp(figName, 'stages config 4') > 0)

			BuildConfigPanel(hObject, event, figName);
            
        elseif(strcmp(figName, 'stages config 5') > 0)

			BuildConfigPanel(hObject, event, figName);

		% Build camera panels
		elseif(strcmp(figName, 'camera status'))

			BuildConfigPanel(hObject, event, figName);

		elseif(strcmp(figName, 'camera image settings'))

			BuildConfigPanel(hObject, event, figName);

		elseif(strcmp(figName, 'camera config'))

			BuildConfigPanel(hObject, event, figName);

		elseif(strcmp(figName, 'camera custom ROI'))

			BuildConfigPanel(hObject, event, figName);

		% Build chiller panels
		elseif(strcmp(figName, 'chiller status'))

			BuildConfigPanel(hObject, event, figName);
            
		elseif(strcmp(figName, 'chiller control'))

			BuildConfigPanel(hObject, event, figName);
        
        % Other panels
        elseif(strcmp(figName, 'Electron integration'))

             BuildConfigPanel(hObject, event, figName);

		elseif(strcmp(figName, 'cli') > 0)

			BuildCLIPanel(hObject, event, figName);

		elseif(strcmp(figName, 'micra status'))

			BuildConfigPanel(hObject, event, figName);

        elseif(strcmp(figName, 'HV status'))

			BuildConfigPanel(hObject, event, figName);
            
        elseif(strcmp(figName, 'oscilloscope measurement'))
            
			BuildConfigPanel(hObject, event, figName);

        end
        
    end

